# プロット
## 前提

本学習を行うにあたっての前提を定義する。
- CPUはIntel それに伴い、x86-64を前提とする。
- gccのバージョンは
- gdbのバージョンは

## アセンブリとは
- アセンブリとは低級言語(低水準言語)
 - 機械語とアセンブリは1対1になる
- 
### 汎用レジスタ

|汎用レジスタ||
|:---:|:---:|
|AX|アキュムレータレジスタ|
|BX|ベースレジスタ|
|CX|カウントレジスタ|
|DX|データレジスタ|

プログラマが自由に使える変数
慣習的にBXにはメモリのアドレスを格納するのに使われる。
CXにはループなどプログラムカウンタとして使われることが多い。
AXには計算結果を格納することが多く、足りなければDXを使うといった形だ。

|インデックスレジスタ||
|:---:|:---:|
|SI|ソースレジスタ|
|DI|ディスティネーションインデックス|

|特殊レジスタ||
|:---:|:---:|
|BP|ベースポインタ|
|SP|スタックポインタ|
|IP|インストラクションポインタ|

|セグメントレジスタ||
|:---:|:---:|
|CS|コードセレクタ|
|DS|データセグメント|
|ES|エクストラセグメント|
|SS|スタックセグメント|

レジスタの基本構造

### アキュムレータレジスタ　RAX
演算結果を格納する。</br>
64bit * 64bitの乗算の結果の下位64bitが格納される。</br>
128bit/64bitの整数除算の場合に被除数の下位64bitが格納される。</br>
Linuxのシステムコール番号の指定に使用</br>
システムコールの結果が格納される。
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RAX|||||
|||||EAX||||
|||||||AX||
|||||||AH|AL|

### ベースレジスタ　RBX
汎用レジスタ
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RBX|||||
|||||EBX||||
|||||||BX||
|||||||BH|BL|

### カウンタレジスタ　RCX
繰り返し回数の設定に使う。
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RCX|||||
|||||ECX||||
|||||||CX||
|||||||CH|CL|

### データレジスタ　RDX
64bit * 64bitの乗算の結果の上位64bitが格納される</br>
128bit / 64bitの整数除算の被除数の上位64bitが格納される。</br>
Linuxのシステムコールの第3引数の設定に使用する。
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RDX|||||
|||||EDX||||
|||||||DX||
|||||||DH|DL|

### ソースインデックスレジスタ　RSI
ストリング型の命令でコピー元(ソース)を示す場合に使用される。</br>
Linuxのシステムコールの第2引数の設定に使用</br>
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RSI|||||
|||||ESI||||
|||||||SI||
||||||||SIL|

### デスティネーションインデックスレジスタ　RDI
ストリング型の命令でコピー先(デスティネーション)を示す場合に使用される。</br>
Linuxのシステムコールの第1引数の設定に使用</br>
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RDI|||||
|||||EDI||||
|||||||DI||
||||||||DIL|

### ベースポインタ　RBP
スタック内のアクセスに使われる。</br>
普通のレジスタとしても利用可能
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RBP|||||
|||||EBP||||
|||||||BP||
||||||||BPL|

### スタックポインタ　RSP
サブルーチンコールの戻りアドレスを格納する</br>
PUSH, POP命令でレジスタを一時退避、復帰する際に使用する。</br>
ただし、64bitモードの場合、ESP、SP、SPLのように部分的にアクセスすることはない。

|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||RSP|||||
|||||ESP||||
|||||||SP||
||||||||SPL|

### 拡張汎用レジスタ　R8-R15
64bitモードで追加された汎用レジスタ</br>
汎用レジスタと同じように使用可能</br>
Linuxのシステムコール呼び出しでは第4引数をR10、第5引数をR8、第6引数をR9に設定する。
|7|6|5|4|3|2|1|0|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
||||R8|||||
|||||R8D||||
|||||||R8W||
||||||||R8B|

### フラグレジスタ　RFFLAGS



レジスタの前、または後についている1文字で、扱うレジスタのバイト長を表す。
|レジスタ{前,後}置記号|場所|ビット幅|バイト幅|備考|利用例|
|:--:|:--:|:--:|:--:|:--:|:--:|
|h|後|8|1|high|ah|
|l|後|8|1|low|al|
|x|後|16|2|eXtended|ax|
|e|前|32|4|Extended|eax|
|r|前|64|8||rax|

### ニーモニック
ニーモニックの基本形

```assembly:title
MOV destination, source
```

第一オペランドをデスティネーションオペランド、第二オペランドをソースオペランドという。

命令を表すニーモニックの最後についている一文字で、扱うデータのバイト長を表す。

|命令の後置記号|ビット幅|バイト幅|備考|利用例|
|:--:|:--:|:--:|:--:|:--:|
|b|8|1|byte|movb|
|w|16|2|word|movw|
|l|32|4|long|movl|
|q|64|8|quad|movq|



## 基礎知識

## 参考文献

https://www.mztn.org/lxasm64/amd04.html